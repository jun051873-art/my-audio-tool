<div id="playerPage" class="page">
    <div class="glass-card">
        <h2>專屬音訊播放</h2>
        
        <div id="recordDisk" class="disk">
            <div class="disk-inner"></div>
        </div>

        <div id="trackName" style="font-size: 0.9rem; color: var(--gold); margin: 20px 0 10px;">尚未選取曲目</div>

        <audio id="mainAudio" style="display:none;"></audio>
        
        <div class="progress-container" onclick="setProgress(event)">
            <div id="progressBar" class="progress-bar"></div>
        </div>

        <div class="controls">
            <button class="ctrl-btn" onclick="togglePlay()" id="playBtn">▶</button>
        </div>

        <button class="btn" style="margin-top:30px; border-style:dashed; opacity:0.6;" onclick="document.getElementById('audioIn').click()">
            ❶ 導入音樂檔案
        </button>
        <input type="file" id="audioIn" accept="audio/*" style="display:none" onchange="loadMusic(event)">
    </div>
</div>

<style>
    /* 唱片旋轉動畫 */
    .disk {
        width: 180px; height: 180px; border-radius: 50%;
        border: 2px solid var(--gold); margin: 0 auto;
        display: flex; justify-content: center; align-items: center;
        background: radial-gradient(circle, #34495e 30%, #1c252e 100%);
        box-shadow: 0 0 30px rgba(0,0,0,0.5);
        transition: transform 0.5s ease;
    }
    .disk.playing { animation: rotateDisk 10s linear infinite; }
    @keyframes rotateDisk { 100% { transform: rotate(360deg); } }
    
    .disk-inner { width: 40px; height: 40px; border-radius: 50%; background: var(--bg); border: 1px solid var(--gold); }

    .progress-container { width: 100%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; cursor: pointer; margin-top: 20px; }
    .progress-bar { width: 0%; height: 100%; background: var(--gold); border-radius: 2px; }

    .controls { margin-top: 25px; }
    .ctrl-btn { 
        width: 60px; height: 60px; border-radius: 50%; border: 1px solid var(--gold);
        background: transparent; color: var(--gold); font-size: 1.5rem; cursor: pointer;
    }
</style>

<script>
    const audio = document.getElementById('mainAudio');
    const playBtn = document.getElementById('playBtn');
    const disk = document.getElementById('recordDisk');
    const progressBar = document.getElementById('progressBar');

    function loadMusic(e) {
        const file = e.target.files[0];
        if(!file) return;
        const url = URL.createObjectURL(file);
        audio.src = url;
        document.getElementById('trackName').innerText = file.name;
        audio.play();
        playBtn.innerText = "⏸";
        disk.classList.add('playing');
    }

    function togglePlay() {
        if(audio.paused) {
            audio.play();
            playBtn.innerText = "⏸";
            disk.classList.add('playing');
        } else {
            audio.pause();
            playBtn.innerText = "▶";
            disk.classList.remove('playing');
        }
    }

    audio.ontimeupdate = () => {
        const per = (audio.currentTime / audio.duration) * 100;
        progressBar.style.width = per + "%";
    };

    function setProgress(e) {
        const width = e.target.clientWidth;
        const clickX = e.offsetX;
        audio.currentTime = (clickX / width) * audio.duration;
    }
</script>
